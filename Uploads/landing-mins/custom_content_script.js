function checkHighlight(){if(!(queried>=4)&&1==weknowhome){var e="";window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),""!=e&&e.length<50&&e!=lastQuery&&(queried++,main(e),ga("send","event","body","highlight",e,queried),queried>=4&&setTimeout(function(){displayLimitAlert()},2e3))}}function main(e){var t=e;lastQuery=t;var a=t;$.ajax({type:"GET",url:"/distance?lat="+latsrc+"&lon="+lonsrc+"&dst="+a,success:function(e){e=JSON.parse(e);var t=e.rows[0],o=t.elements[0],i=o.status,n=e.destination_addresses[0],s=e.origin_addresses[0];if("ZERO_RESULTS"==i){var l=-1,d=-1;$.ajax({type:"GET",url:"/geocode?dst="+a,success:function(e){e=JSON.parse(e),l=e.results[0].geometry.location.lat,d=e.results[0].geometry.location.lng;var t=getFlight(l,d,latsrc,lonsrc),a="<i class='fa fa-paper-plane-o'></i>  "+t+" hour";1!=t&&(a+="s"),alertUser(s,n,"",a,"","",0,1,0,0)}})}else if("OK"==i){var r=o.distance,m=o.duration,c=" <i class='fa fa-car'></i>  "+m.text,u=" <i class='fa fa-paper-plane-o'></i>  ",y=" <i class='zmdi zmdi-directions-walk'></i>  ",h=" <i class='fa fa-bicycle'></i>  ";if(r.value<=Math.max(maxWalkDist,maxBikeDist)){var g,f=r.value/maxWalkSpd,p=0|f;g=1>f?" ":2>f?" "+p+" hour":" "+p+" hours";var k=Math.ceil(60*(f-p)),v=" "+k+" min";1!=k&&(v+="s"),y+=g+v;var w,B=r.value/maxBikeSpd,x=0|B;w=1>B?" ":2>B?" "+x+" hour":" "+x+" hours";var b=Math.ceil(60*(B-x)),E=" "+b+" min";return 1!=b&&(E+="s"),h+=w+E,void(maxWalkTimeH>=p&&maxWalkTimeM>=k?alertUser(s,n,c,u,h,y,3,0,2,1):maxBikeTimeH>=x&&maxBikeTimeM>=b?alertUser(s,n,c,u,h,y,2,0,1,3):alertUser(s,n,c,u,h,y,1,0,2,3))}if(m.value<7200)alertUser(s,n,c,u,h,y,1,0,0,0);else{var l=-1,d=-1;$.ajax({type:"GET",url:"/geocode?dst="+a,success:function(e){e=JSON.parse(e),l=e.results[0].geometry.location.lat,d=e.results[0].geometry.location.lng;var t=getFlight(l,d,latsrc,lonsrc);u+=t+" hour",1!=t&&(u+="s"),m.value<36e3?alertUser(s,n,c,u,h,y,1,2,0,0):alertUser(s,n,c,u,h,y,2,1,0,0)}})}}}})}function findWidth(e,t,a,o){var i=e+t+a+o;return 10==i?"four":6==i?"three":3==i?"two":"one"}function resetBodyClass(){document.getElementsByTagName("body")[0].className=document.getElementsByTagName("body")[0].className.replace(/\bone\b/,""),document.getElementsByTagName("body")[0].className=document.getElementsByTagName("body")[0].className.replace(/\btwo\b/,""),document.getElementsByTagName("body")[0].className=document.getElementsByTagName("body")[0].className.replace(/\bthree\b/,""),document.getElementsByTagName("body")[0].className=document.getElementsByTagName("body")[0].className.replace(/\bfour\b/,"")}function displayLimitAlert(){document.getElementById("try").style.display="none",document.getElementById("trialdone").style.display="block",document.getElementById("install").style.display="none",document.getElementById("installpl").style.display="block"}function alertUser(e,t,a,o,i,n,s,l,d,r){var m="https://www.google.com/maps/dir/"+e+"/"+t;t="<div id = 'address'>"+t+"</div>";var c=" "+findWidth(r,d,l,s),u=t,y="<a href='"+m+"' target='_blank' ><i class='fa fa-external-link'></i></a>";y="<div id = 'links' tooltip='See route' tooltip-persistent>"+y+"</div>",u+="<div id = 'info'>",a="<div class = 'mode'>"+a+"</div>",o="<div class = 'mode'>"+o+"</div>",i="<div class = 'mode'>"+i+"</div>",n="<div class = 'mode'>"+n+"</div>",u+=1==s?a:1==l?o:1==d?i:1==r?n:"",u+=2==s?a:2==l?o:2==d?i:2==r?n:"",u+=3==s?a:3==l?o:3==d?i:3==r?n:"",u+=4==s?a:4==l?o:4==d?i:4==r?n:"",u+="</div>",u+=y;var h=document.createElement("div");h.innerHTML=u,h.id="Wector",h.style.position="fixed",h.style.bottom="0",h.style.left="0",h.style.width="100%",h.style.background="rgba(0,0,0,0.9)",h.style.color="white",h.style.font="menu",h.style.fontSize="16px",h.style.border="0",h.style.borderRadius="0px",h.style.zIndex="2147483648",h.style.textAlign="center",h.style.display="none",h.onclick=function(){lastQuery="",$(h).slideUp("fast",function(){document.body.removeChild(h)})};var g=document.getElementById("Wector");null==g?(resetBodyClass(),document.getElementsByTagName("body")[0].className+=c,document.body.appendChild(h),$(h).slideDown("fast",function(){var e=$("#address").height();document.getElementById("info").style.lineHeight=e+"px",document.getElementById("links").style.lineHeight=e+"px";var t=$("#address").width()+$("#info").width()+$("#links").width(),a=$(this).width();Math.abs(1.03*t-a)>5&&(document.getElementById("address").style.width="36%",document.getElementById("info").style.width="60%",document.getElementById("links").style.width="4%")}),setTimeout(function(){$(h).slideUp("fast",function(){document.contains(h)&&document.body.removeChild(h)})},6660)):$(g).slideUp("fast",function(){document.body.removeChild(g),resetBodyClass(),document.getElementsByTagName("body")[0].className+=c,document.body.appendChild(h),$(h).slideDown("fast",function(){var e=$("#address").height();document.getElementById("info").style.lineHeight=e+"px",document.getElementById("links").style.lineHeight=e+"px";var t=$("#address").width()+$("#info").width()+$("#links").width(),a=$(this).width();Math.abs(1.03*t-a)>5&&(document.getElementById("address").style.width="36%",document.getElementById("info").style.width="60%",document.getElementById("links").style.width="4%")}),setTimeout(function(){$(h).slideUp("fast",function(){document.contains(h)&&document.body.removeChild(h)})},6660)})}function initializeHome(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition,showError):(document.getElementById("inst").innerHTML="It looks like your browser doesn't allow us to get your location :(",document.getElementById("inst").style.cursor="auto")}function showError(e){console.log(e.code),document.getElementById("inst").innerHTML="Oops, something went wrong. Your browser didn't tell us where you are :(",document.getElementById("inst").style.cursor="auto"}function showPosition(e){latsrc=e.coords.latitude,lonsrc=e.coords.longitude,maxWalkSpd=5e3,maxBikeSpd=14e3,maxWalkTimeH=0,maxBikeTimeH=0,maxWalkTimeM=30,maxBikeTimeM=30,maxWalkDist=maxWalkSpd*(maxWalkTimeH+maxWalkTimeM/60),maxBikeDist=maxBikeSpd*(maxBikeTimeH+maxBikeTimeM/60),weknowhome=!0,latsrc&&lonsrc?(document.getElementById("inst").innerHTML="Awesome! Now <span class='lighter'>highlight</span> any of these places to find out how far they are from you:",document.getElementById("inst").style.cursor="auto",document.getElementById("places").style.display="block",$("html, body").animate({scrollTop:$(document).height()-$(window).height()})):showError(null)}function getFlight(e,t,a,o){var i=haversine(e,t,a,o),n=Math.min(i,300),s=i-n,l=n/400,d=s/800,r=l+d;return Math.ceil(100*r/100)}function haversine(){var e=Array.prototype.map.call(arguments,function(e){return e/180*Math.PI}),t=e[0],a=e[1],o=e[2],i=e[3],n=6372.8,s=o-t,l=i-a,d=Math.sin(s/2)*Math.sin(s/2)+Math.sin(l/2)*Math.sin(l/2)*Math.cos(t)*Math.cos(o),r=2*Math.asin(Math.sqrt(d));return n*r}console.log("Thanks for checking out Wector! See our code on GitHub: https://github.com/khaaliDimaag/Wector");var weknowhome=!1,latsrc,lonsrc,home,hasSet,maxWalkSpd,maxBikeSpd,maxWalkTimeH,maxBikeTimeH,maxWalkTimeM,maxBikeTimeM,maxWalkDist,maxBikeDist,lastQuery="",queried=0;document.onmouseup=checkHighlight,document.ontouchend=checkHighlight;